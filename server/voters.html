<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>

<center>
    <h1>Voters on Chaos</h1>
    <div id="result"></div>
</center>

<script>
    console.log(getText());

    function getText() {
        var result = document.getElementById("result");
        // read text from URL location
        var request = new XMLHttpRequest();
        request.open('GET', 'voters.json', true);
        request.send(null);
        request.onreadystatechange = function() {
            if (request.readyState === 4 && request.status === 200) {
                var type = request.getResponseHeader('Content-Type');
                if (type.indexOf("text") !== 1) {
                    var json = JSON.parse(request.responseText);
                    var keys = Object.keys(json);
                    var values = Object.values(json);

                    //1) combine the arrays:
                    var list = [];
                    for (var j = 0; j < keys.length; j++)
                        list.push({
                            'names': keys[j],
                            'votes': values[j]
                        });

                    //2) sort:
                    list.sort(function(a, b) {
                        return -((a.votes < b.votes) ? -1 : ((a.votes == b.votes) ? 0 : 1));
                    });

                    console.log(list);
                    var tablehtml = "<table>";
                    for (var i = 0; i < list.length; i++) {
                        tablehtml += "<tr><td>" + list[i].names + "</td><td>" + list[i].votes + "</tr>";
                    }
                    tablehtml += "</table>";
                    result.innerHTML = tablehtml;
                }
            }
        }
    }
</script>
